---
title: "Simulasi Monte Carlo"
subtitle: "Memvisualisasikan Masalah Jarum Buffon"
description: "Bagaimana menggunakan simulasi Monte Carlo untuk menyelesaikan masalah jarum Buffon? Artikel ini akan mendemonstrasikan bagaimana memvisualisasikan dan menganimasikan simulasi Monte Carlo untuk masalah paling awal yang diajukan dan diselesaikan di Peluang Geometris, yaitu masalah jarum Buffon."
draft: true
author:
  - name: Yosep Dwi Kristanto
    url: https://people.usd.ac.id/~ydkristanto/
    affiliation: Pendidikan Matematika, Universitas Sanata Dharma, Yogyakarta
    affiliation-url: https://www.usd.ac.id/s1pmat
    orcid: 0000-0003-1446-0422
date: 2025-10-31
categories:
  - Peluang
  - Geometri
  - tutorial
image: "sampul-masalah-jarum-buffon.png"
image-alt: "Simulasi masalah jarum Buffon untuk memvisualisasikan peluang jarum melintasi garis"
keywords: 
  - eksperimen
  - Hukum Bilangan Besar
  - masalah jarum Buffon
  - simulasi Monte Carlo
lightbox: true
copyright: "© 2025 Yosep Dwi Kristanto"
license: "CC BY"
code-annotations: below
editor_options: 
  chunk_output_type: console
---

Bayangkan kamu bermain sebuah gim. Dalam gim tersebut, kamu memiliki selembar kertas bergaris dan lidi. Panjang lidi tersebut sama dengan jarak antargaris pada kertas itu. Jika lidi tersebut dilemparkan secara acak ke kertas tersebut, kamu perlu menebak apakah lidi tersebut mengenai garis atau tidak. Jika tebakanmu benar, kamu menang. Tebakan mana yang kamu pilih?

Gim itu adalah bentuk adaptasi dari sebuah masalah paling awal yang diajukan dan diselesaikan di [Peluang Geometris](https://doi.org/10.1007/s004070100038 "Nineteenth-Century Developments in Geometric Probability: J. J. Sylvester, M. W. Crofton, J.-É. Barbier, and J. Bertrand"){.external target="_blank"}, masalah jarum Buffon. Masalah ini menarik karena melibatkan peluang dan geometri. Dengan demikian, kita akan memvisualisasikan masalah ini secara geometris untuk dapat melihat berapa peluangnya. Untuk melakukannya, kita menggunakan simulasi Monte Carlo.

## Simulasi Monte Carlo {#sec-simulasi-monte-carlo}

Simulasi Monte Carlo, atau sering dikenal dengan metode Monte Carlo, merupakan sebuah teknik matematis yang digunakan untuk memperkirakan kemungkinan luaran dari kejadian yang tak pasti. Dengan demikian, kita dapat menggunakan simulasi ini terhadap masalah jarum Buffon. Tujuannya beberapa hal, yaitu untuk:

-   membandingkan banyaknya jarum yang melintasi garis dan tidak dalam sebuah eksperimen;

-   mengilustrasikan [Hukum Bilangan Besar](https://people.usd.ac.id/~ydkristanto/app/hukum-bil-besar/ "Hukum Bilangan Besar"){.external target="_blank"} terhadap peluang empiris kejadian jarum yang melintasi garis;

-   memperkirakan nilai pi ($\pi$).

Selanjutnya, mari kita melakukan tujuan yang pertama pada bagian berikutnya.

## Simulasi Masalah Jarum Buffon {#sec-simulasi-masalah-jarum-buffon}

Kita menggunakan [pemrograman R](https://www.R-project.org/ "R Foundation for Statistical Computing"){.external target="_blank"} untuk mensimulasikan masalah jarum Buffon. Untuk melakukannya, kita memanfaatkan tiga paket, yaitu [{tidyverse}](https://tidyverse.org/ "R packages for Data Science"){.external target="_blank"}, [{gganimate}](https://CRAN.R-project.org/package=gganimate "gganimate: A Grammar of Animated Graphics"){.external target="_blank"}, dan [{magick}](https://CRAN.R-project.org/package=magick "magick: Advanced Graphics and Image-Processing in R"){.external target="_blank"}. Mari terlebih dahulu kita memanggil ketiga paket tersebut.

```{r}
#| warning: false
#| message: false
#| code-fold: false

library(tidyverse) # <1>
library(gganimate) # <2>
library(magick)    # <3>

```

1.  Kita menggunakan {tidyverse} untuk mempersiapkan data dalam mensimulasikan masalah jarum Buffon.
2.  Paket {gganimate} kita gunakan untuk menganimasikan simulasi masalah jarum Buffon.
3.  Kita memanfaatkan {magick} untuk menggabungkan gambar-gambar animasi ke dalam sebuah gambar animasi yang tersinkron.

### Deskripsi Masalah {#sec-deskripsi-masalah}

Masalah jarum Buffon kurang lebih deskripsinya adalah sebagai berikut.

> Perhatikan selembar kertas bergaris-garis sejajar yang jarak antargaris berdekatannya $d$ satuan dan sebuah jarum yang panjangnya $l$, dengan $l = d$. Jika kita melemparkan jarum tersebut pada kertas itu secara acak, berapakah peluang jarum tersebut memotong garis pada kertas itu?

Tanpa mengurangi generalisasi, kita dapat mengasumsikan bahwa garis-garis pada kertas itu adalah garis-garis yang horizontal dan jarak antargaris berdekatannya $d=1$ satuan. Dengan demikian, panjang jarumnya $l = d = 1$. Asumsi seperti ini akan memudahkan kita untuk mensimulasikan masalah tersebut.

Terdapat dua elemen penting dalam memvisualisasikan masalah jarum Buffon tersebut, yaitu kertas bergaris dan jarumnya. Kedua elemen tersebut dapat kita visualisasikan dengan {ggplot2}, yang merupakan bagian dari {tidyverse}. Selanjutnya, kita bahas kedua elemen tersebut pada @sec-selembar-kertas dan @sec-sebuah-jarum.

### Selembar Kertas {#sec-selembar-kertas}

Kita memilih kertas yang berukuran 10 × 10. Karena kertas ini bergaris-garis horizontal dan jarak antargaris berdekatannya 1 satuan, kita dapat memvisualisasikannya dengan menggunakan kode pada @lst-kertas-bergaris. Hasilnya ditunjukkan pada @fig-kertas-bergaris.

```{r}
#| code-fold: false
#| lst-label: lst-kertas-bergaris
#| lst-cap: "Kode untuk membuat kertas bergaris"
#| label: fig-kertas-bergaris
#| fig-cap: "Kertas bergaris horizontal berukuran 10 × 10 yang jarak antargarisnya 1 satuan"

kertas <- ggplot() + 
  geom_hline(
    yintercept = 0:10,
    color = "gray80",
    linewidth = 0.5
  ) + 
  coord_equal(
    xlim = c(0, 10),
    ylim = c(0, 10)
  ) + 
  scale_x_continuous(
    breaks = 0:10
  ) + 
  scale_y_continuous(
    breaks = 0:10
  ) + 
  theme_bw() + 
  theme(
    axis.title = element_blank(),
    panel.grid = element_blank(),
    plot.margin = unit(c(.5, .5, .5, .5), "cm")
  )

kertas

```

### Sebuah Jarum {#sec-sebuah-jarum}

Bagaimana kita dapat membuat jarumnya? Kita dapat memvisualisasikan jarum dalam masalah ini dengan menggunakan ruas garis yang ujung-ujungnya adalah titik-titik $\left( x_{1}, y_{1} \right)$ dan $\left( x_{2}, y_{2} \right)$, perhatikan @fig-sebuah-jarum.

![Sebuah jarum yang direpresentasikan dengan sebuah ruas garis](aset/sebuah-jarum-01.png){#fig-sebuah-jarum}

Koordinat kedua ujung ruas garis tersebut saling berkaitan karena jarak keduanya haruslah $l=1$ satuan. Jika $\theta$ adalah besar sebuah sudut yang dibentuk oleh sebuah sinar garis horizontal ke kanan yang pangkalnya $\left(x_{1},y_{1}\right)$ dan ruas garis tersebut, koordinat $\left( x_{2}, y_{2} \right)$ dapat ditentukan dengan menggunakan @eq-koord-titik-kedua.

$$
\begin{matrix}
x_{2}=x_{1}+1\cdot\cos\left(\theta\right)\\
y_{2}=y_{1}+1\cdot\sin\left(\theta\right)
\end{matrix}
$$ {#eq-koord-titik-kedua}

dengan $0 \leq \theta \leq 2\pi$. Berdasarkan @eq-koord-titik-kedua, kita memerlukan tiga nilai, yaitu $x_{1}$, $y_{1}$, dan $\theta$, untuk membuat sebuah jarum pada kertas. Sebagai contoh, untuk $x_{1}=6$, $y_{1}=\text{5,5}$, dan $\theta=\frac{4}{3}\pi$, jarumnya disajikan pada @fig-contoh-jarum.

```{r}
#| echo: false
#| label: fig-contoh-jarum
#| fig-cap: 'Sebuah jarum dengan $x_{1}=4$, $y_{1}=\text{5,5}$, dan $\theta=\frac{4}{3}\pi$'

x_1 <- 6
y_1 <- 5.5
t_heta <- 4 / 3 * pi

contoh_jarum <- ggplot() + 
  geom_hline(
    yintercept = 0:10,
    color = "gray80",
    linewidth = 0.5
  ) + 
  annotate(
    geom = "segment",
    x = x_1, xend = x_1 + 1 * cos(t_heta),
    y = y_1, yend = y_1 + 1 * sin(t_heta),
    color = "#4269d0",
    linewidth = 1.5
  ) + 
  coord_equal(
    xlim = c(0, 10),
    ylim = c(0, 10)
  ) + 
  scale_x_continuous(
    breaks = 0:10
  ) + 
  scale_y_continuous(
    breaks = 0:10
  ) + 
  theme_bw() + 
  theme(
    axis.title = element_blank(),
    panel.grid = element_blank(),
    plot.margin = unit(c(.5, .5, .5, .5), "cm")
  )

contoh_jarum

```

@fig-contoh-jarum memperlihatkan secara jelas bahwa jarumnya memotong sebuah garis. Namun bagaimana kita dapat mengetahui apakah sembarang jarum yang diketahui $x_{1}$, $y_{1}$, dan $\theta$-nya memotong garis atau tidak? Untuk menjawab pertanyaan ini, perhatikan @fig-jarum-dan-garis.

![Jarum-jarum yang memotong garis dan yang tidak](aset/jarum-dan-garis-01.png){#fig-jarum-dan-garis}

Berdasarkan @fig-jarum-dan-garis, kita dapat melihat bahwa jarum yang memotong garis pada kertas nilai $h$-nya lebih besar dari jarak vertikal antara titik tengah jarum tersebut dan garis terdekatnya, yaitu $d_{h}$. Padahal, $h=\frac{1}{2}\cdot\sin\left(\theta_{l}\right)$ degan $\theta_{l}$ adalah sudut lancip yang dibentuk oleh jarum dan garis horizontal.

Perhatikan juga bahwa garis-garis pada kertas yang kita buat pada @lst-kertas-bergaris memiliki koordinat-$y$ yang merupakan bilangan bulat. Dengan demikian, kita mendapatkan $d_{h}=\text{min}\left(\left | y_{t}-\left \lfloor y_{t}\right \rfloor\right |,\left | y_{t}-\left \lceil y_{t}\right \rceil\right |\right)$ dengan $y_{t}$ adalah koordinat-$y$ titik tengah jarum tersebut. Dengan demikian, sebuah jarum yang memotong garis memenuhi kondisi pada @eq-kondisi.

$$
\frac{1}{2}\sin\left(\theta_{l}\right)\geq \text{min}\left(\left | y_{t}-\left \lfloor y_{t}\right \rfloor\right |,\left | y_{t}-\left \lceil y_{t}\right \rceil\right |\right)
$$ {#eq-kondisi}

Kita gunakan kondisi tersebut terhadap jarum pada @fig-contoh-jarum untuk menentukan apakah jarum tersebut memotong garis atau tidak (walaupun faktanya kita telah mengetahuinya).

```{r}
#| code-fold: false
#| lst-label: lst-uji-kondisi
#| lst-cap: 'Menguji kondisi apakah jarumnya memotong garis'

y_t <- (y_1 + (y_1 + sin(t_heta))) / 2 # <1>
theta_l <- abs(t_heta %% pi - pi/2)   # <2>
h <- 1 / 2 * sin(theta_l)             # <3>
d_h <- min(                           # <4>
  abs(y_t - floor(y_t)),              # <4>
  abs(y_t - ceiling(y_t))             # <4>
)

potong_garis <- if_else(                # <5>
  h >= d_h, "Memotong", "Tak memotong"  # <5>
)                                       # <5>

potong_garis                            # <6>

```

1.  Menghitung koordinat-$y$ titik tengah jarum, dan nilainya dinamai dengan `y_t`.
2.  Menentukan sudut lancip $\theta_{l}$ dan hasilnya kita namai dengan `theta_l`.
3.  Menghitung nilai $h$.
4.  Menghitung nilai $d_{h}$ dan hasilnya dinamai dengan `d_h`.
5.  Mendefinisikan kondisi yang telah dibahas sebelumnya, dan hasilnya dinamai dengan `potong_garis`.
6.  Mencetak nilai `potong_garis`.

Kita telah berhasil menggunakan kondisi di atas untuk menentukan apakah jarum pada @fig-contoh-jarum memotong garis atau tidak. Hasilnya sesuai dengan pengamatan kita tentu saja.

### Eksperimen Pelemparan Jarum {#sec-eksperimen-pelemparan-jarum}

Sampai di sini kita telah dapat membuat selembar kertas dan sebuah jarum. Kita juga telah mengetahui kondisi jarum tersebut untuk memotong garis pada kertas. Sekarang kita akan memvisualisasikan sebuah eksperimen pelemparan jarum sebanyak $n$ kali. Misalnya, kita memilih $n = 100$ kali. Setiap pelemparan tersebut kita perlu menyediakan tiga nilai, yaitu $x_{1}$, $y_{1}$, dan $\theta$, secara acak. Dalam R, kita dapat menggunakan fungsi `runif()`. Fungsi ini akan memberikan satu atau lebih nilai acak dari distribusi seragam dengan nilai minimum dan maksimum yang diberikan.

Kita buat sebuah data dengan nama `data_eksperimen` untuk memuat hasil eksperimen pelemparan jarum sebanyak $n=100$ kali tersebut. Untuk melakukannya, kita gunakan kode berikut. Kita cetak beberapa baris awalnya dengan `head()`.

```{r}
#| code-fold: false
#| lst-label: lst-data-eksperimen
#| lst-cap: 'Membuat `data_eksperimen` yang memuat luaran setiap percobaan dalam eksperimen'

set.seed(1234)         # <1>
palet_warna <- c(      # <2>
  "#4269d0","#efb118", # <2>
  "#ff725c","#6cc5b0", # <2>
  "#3ca951","#ff8ab7", # <2>
  "#a463f2","#97bbf5", # <2>
  "#9c6b4e","#9498a0"  # <2>
)                     # <2>

data_eksperimen <- tibble(
  x1 = runif(100, min = 1, max = 9),        # <3>
  y1 = runif(100, min = 1, max = 9),        # <3>
  theta = runif(100, min = 0, max = 2 * pi) # <3>
) |> 
  mutate(                                      # <4>
    percobaan = row_number(),                  # <4>
    x2 = x1 + 1 * cos(theta),                  # <4>
    y2 = y1 + 1 * sin(theta),                  # <4>
    warna = palet_warna[(percobaan %% 10) + 1] # <4>
  )

head(data_eksperimen)

```

1.  Mengatur benih pengacakan agar hasilnya dapat diproduksi kembali.
2.  Membuat palet warna sebagai warna setiap jarumnya.
3.  Menyediakan bilangan-bilangan `x1`, `y1`, dan `theta` secara acak.
4.  Menghitung `x2` dan `y2`, serta membuat variabel `percobaan` untuk memberikan identitas terhadap setiap percobaannya dan `warna` untuk memberikan warna terhadap setiap jarum yang dihasilkan.

Kita telah memiliki `data_eksperimen`. Agar kita dapat melihat hasil eksperimen yang terdata dalam data tersebut, kita dapat memvisualisasikan hasil eksperimennya dengan kode pada @lst-vis-hasil-eksperimen. Hasilnya ditunjukkan pada @fig-vis-hasil-eksperimen.

```{r}
#| code-fold: false
#| lst-label: lst-vis-hasil-eksperimen
#| lst-cap: 'Memvisualisasikan setiap luaran dalam eksperimen'
#| label: fig-vis-hasil-eksperimen
#| fig-cap: 'Hasil pelemparan secara acak 100 jarum pada selembar kertas'

hasil_eksperimen <- data_eksperimen |> 
  ggplot() + 
  geom_hline(
    yintercept = 0:10,
    color = "gray80",
    linewidth = 0.5
  ) + 
  geom_segment(
    aes(
      x = x1, y = y1,
      xend = x2, yend = y2,
      color = warna
    ),
    linewidth = 1.5
  ) + 
  coord_equal(
    xlim = c(0, 10),
    ylim = c(0, 10)
  ) + 
  scale_x_continuous(
    breaks = 0:10
  ) + 
  scale_y_continuous(
    breaks = 0:10
  ) + 
  scale_color_identity() + 
  theme_bw() + 
  theme(
    legend.position = "none",
    axis.title = element_blank(),
    panel.grid = element_blank(),
    plot.margin = unit(c(.5, .5, .5, .5), "cm")
  )

hasil_eksperimen

```

Sekarang kita akan menentukan apakah setiap percobaan dalam `data_eksperimen` menghasilkan jarum yang memotong garis atau tidak. Untuk melakukannya, kita menerapkan ide pada @lst-uji-kondisi untuk membuat variabel baru, yaitu `potong`, dalam data tersebut. Perhatikan @lst-data-eksperimen-lengkap!

```{r}
#| code-fold: false
#| lst-label: lst-data-eksperimen-lengkap
#| lst-cap: 'Menambahkan informasi apakah jarumnya memotong garis atau tidak'

data_eksperimen <- data_eksperimen |> 
  mutate(
    yt = (y1 + y2) / 2,
    theta_l = abs(theta %% pi - pi/2),
    h = 1 / 2 * sin(theta_l),
    d_h = pmin(
      abs(yt - floor(yt)),
      abs(yt - ceiling(yt))
    ),
    potong = if_else(
      h >= d_h,
      "Memotong",
      "Tak memotong"
    )
  )

head(data_eksperimen)

```

### Visualisasi Hasil Eksperimen {#sec-visualisasi-hasil-eksperimen}

Untuk mengetahui apakah lebih banyak jarum yang memotong garis ataukah yang tidak, kita dapat memvisualisasikan nilai-nilai dalam variabel `potong` dengan menggunakan diagram batang. Perhatikan @fig-diag-batang-potong!

```{r}
#| label: fig-diag-batang-potong
#| fig-cap: 'Frekuensi jarum yang memotong atau tak memotong garis'
#| fig-asp: 0.75

data_eksperimen |> 
  ggplot(aes(x = potong, fill = potong)) + 
  geom_bar() + 
  scale_fill_manual(
    values = c(
      "Memotong" = "#4269d0",
      "Tak memotong" = "#ff725c"
    )
  ) + 
  theme_minimal() + 
  theme(
    legend.position = "none",
    axis.title.x = element_blank()
  ) + 
  labs(
    y = "Frekuensi"
  )

```

Berdasarkan eksperimen kita tersebut, berapakah peluang empiris (frekuensi relatif) jarum yang memotong garis? Kita dapat menjawabnya dengan kode pada @lst-peluang-empitis.

```{r}
#| code-fold: false
#| lst-label: lst-peluang-empiris
#| lst-cap: 'Menentukan peluang empiris'

ringkasan_eksperimen <- data_eksperimen |> 
  group_by(potong) |> 
  summarise(
    n = n(),
    .groups = "drop"
  )

p_memotong <- ringkasan_eksperimen$n[1] / sum(ringkasan_eksperimen$n)
print(p_memotong)

```

Kita telah mengetahui bahwa peluang empirisnya adalah `r round(p_memotong, 2)`. Bagaimana dengan peluang empirisnya pada percobaan pertama, kedua, ketiga, dan seterusnya sampai ke-100? Untuk itu, kita hitung terlebih dahulu peluang empirisnya untuk setiap percobaannya dengan menggunakan kode pada @lst-peluang-empiris.

```{r}
#| code-fold: false
#| lst-label: lst-peluang-empiris
#| lst-cap: 'Menghitung peluang empiris untuk setiap percobaan'
data_eksperimen <- data_eksperimen |> 
  mutate(
    potong_numerik = if_else(
      potong == "Memotong", 1, 0
    ),
    peluang_empiris = cumsum(potong_numerik) / percobaan
  )

glimpse(data_eksperimen)

```

Sekarang, kita visualisaikan perubahan peluang empirisnya dari satu percobaan ke percobaan lainnya. Perhatikan @fig-tren-peluang-empiris!

```{r}
#| label: fig-tren-peluang-empiris
#| fig-cap: 'Tren peluang empiris'
#| fig-asp: 0.5625

tren_p_empiris <- data_eksperimen |> 
  ggplot(aes(x = percobaan, y = peluang_empiris)) +
  geom_line(
    color = "#4269d0",
    linewidth = 1
  ) +
  theme_minimal() + 
  labs(
    x = "Percobaan",
    y = "Peluang empiris"
  )

tren_p_empiris
```

Kita juga dapat memvisualisasikan apakah setiap percobaan dalam eksperimen tersebut menghasilkan jarum yang memotong garis atau tidak dengan menggunakan @eq-kondisi. Caranya, kita representasikan setiap percobaan dalam eksperimen tersebut dengan titik $\left(\theta_{l},d_{h}\right)$. Jika titik tersebut di atas kurva $y=\frac{1}{2}\sin\left(x\right)$, percobaannya menghasilkan jarum yang memotong garis. Dengan menggunakan ide seperti ini, kita mendapatkan visualisasi yang disajikan pada @fig-luaran-percobaan-sin.

```{r}
#| label: fig-luaran-percobaan-sin
#| fig-cap: 'Hasil setiap percobaan dalam eksperimen'
#| fig-asp: 0.5625

data_eksperimen |> 
  ggplot(aes(x = theta_l, y = d_h)) +
  geom_function(
    fun = function(x) 0.5 * sin(x),
    color = "#efb118",
    linewidth = 1
  ) +
  geom_point(
    aes(color = potong),
    size = 3
  ) +
  scale_color_manual(
    values = c(
      "Memotong" = "#ff725c",
      "Tak memotong" = "#4269d0"
    ),
    name = "Hasil percobaan"
  ) +
  theme_minimal() + 
  theme(
    legend.position = "bottom"
  ) + 
  labs(
    x = expression(theta[l]),
    y = expression(d[h])
  )
```
